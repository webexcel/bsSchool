<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button>
        <ion-icon [ios]="'menu-sharp'" [md]="'menu-sharp'"></ion-icon>
      </ion-menu-button>
    </ion-buttons>
    <ion-title>{{ "homework" | translate }}</ion-title>
    <ion-buttons slot="end">
      <ion-button routerDirection="root" routerLink="/dashboard" lines="none" detail="false"
        routerLinkActive="selected">
        <ion-icon name="grid" style="height: 24px; width: 24px"> </ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <pinch-zoom backgroundColor="rgba(0,0,0,0)">
    <div style="height: 100% !important; width: 100%">
      <div class="homework">
        <app-segment (item)="selected($event)"></app-segment>

        <ion-card class="borbot" *ngFor="let hmData of homeworkdates; let i = index">
          <ion-card-content>
            <div style="display: flex; align-items: center; justify-content: space-between; margin: 5px;">
              <span style="display: flex; align-items: center;">
                <img style="border: 1px solid rgb(233, 233, 233); border-radius: 20px; width: 25px; height: 25px;"
                  [src]="studentProfile == null || studentProfile == undefined || studentProfile == '' ? '../../assets/imgs/student.png' : studentProfile"
                  alt="profImg" />
                <span style="color: #5886FE; margin-left: 5px;">{{ hmData.subject }}</span>
              </span>
              <span style="margin-right: 5px;">{{ hmData.MSG_DATE }}</span>
            </div>
            <div style="margin: 5px;">
              <div style="width: 100px; float: left; height: 60px; margin: 5px;"
                (click)="setOpen(true, hmData.event_image, 'img')" *ngIf="checkimage(hmData.event_image)">
                <img [src]="hmData.event_image" alt="evt_img" style="width: 100px; height: 60px;">
              </div>
              <div *ngIf="checkmp3(hmData.event_image)">
                <audio controls controlsList="noplaybackrate nodownload" style="width: 100%; border-radius: 20px;">
                  <!-- <source src="{{ hmData.base64 }}" type="audio/mpeg" *ngIf="hmData.base64.length > 0" /> -->
                  <source src="{{ hmData.event_image }}" type="audio/mpeg" *ngIf="hmData.event_image.length > 0" />
                </audio>
              </div>
              <div *ngIf="checkmp4(hmData.event_image)" (click)="setOpen(true, hmData.event_image, 'video')"
                style="width: 100px; float: left; height: 60px; margin: 5px; border: 1px solid #ededed; border-radius: 20px;">
                <div><ion-icon name="play"
                    style="width: 50%; height: 40px; margin-left: 25px; margin-top: 10px;"></ion-icon></div>
              </div>
              <div class="card-header" *ngIf="checkpdf(hmData.event_image)">
                <div style="width: 40px; float: left; height: 40px; margin: 5px; padding-left: 5px;"
                  (click)="authservice.open(hmData.event_image)">
                  <img class="w-50 m-auto" src="../../assets/imgs/speakers/spdf.png" />
                </div>
              </div>
              <div class="card-header" *ngIf="checkxls(hmData.event_image)">
                <div style="width: 40px; float: left; height: 40px; margin: 5px; padding-left: 5px;"
                  (click)="authservice.open(hmData.event_image)">
                  <img class="w-50 m-auto" src="../../assets/imgs/Icons_new/Microsoft Excel.png" />
                </div>
              </div>
              <div class="card-header" *ngIf="checkdoc(hmData.event_image)">
                <div style="width: 40px; float: left; height: 40px; margin: 5px; padding-left: 5px;"
                  (click)="authservice.open(hmData.event_image)">
                  <img class="w-50 m-auto" src="../../assets/imgs/Icons_new/DOC.png" />
                </div>
              </div>
              <div>
                <pre [innerHTML]="authservice.linksAndMails( hmData.MESSAGE)"></pre>
                <!-- <p>{{hmData.MESSAGE}}</p> -->
              </div>
            </div>
            <ion-modal [isOpen]="isModalOpen">
              <ng-template>
                <ion-header>
                  <ion-toolbar>
                    <ion-buttons slot="end">
                      <ion-button (click)="setOpen(false, 't', '')">Close</ion-button>
                    </ion-buttons>
                  </ion-toolbar>
                </ion-header>
                <ion-content class="ion-padding">
                  <div *ngIf="type == 'img'">
                    <pinch-zoom backgroundColor="rgba(0,0,0,0)">
                      <div>
                        <img class="card-img-top w-100" src="{{ this.modalImage }}" alt="" />
                      </div>
                    </pinch-zoom>
                  </div>
                  <div *ngIf="type == 'video'">
                    <video [src]="modalImage" controls style="width: 100%;"></video>
                  </div>
                </ion-content>
              </ng-template>
            </ion-modal>
          </ion-card-content>
        </ion-card>


        <!-- <ion-card class="card-cls" *ngIf="homeworkdates.length > 0 && sname.length > 0">
          <ion-card-content>
            <div *ngFor="let l of homeworkdates; let i = index" style="margin-bottom: 1em">
              <table class="custom-table">
                <thead>
                  <tr>
                    <th colspan="2" style="
                        text-align: center;
                        background-color: #26a6f0 !important;
                        padding: 0.5em;
                        font-weight: bold;
                        font-size: 18px;
                        color: black; 
                      ">
                      {{ l }}
                    </th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let x of homeworkdata[l]" ngPreserveWhitespaces>
                    <td width="20%">{{ x.subject }}</td>
                    <td>
                      <pre style="margin: 0; padding: 0; white-space: pre-wrap;"
                        [innerHTML]="authservice.urlify( x.MESSAGE)"></pre>
                      <div class="openImage" (click)="setOpen(true, x.event_image)" *ngIf="checkimage(x.event_image)">
                        <div style="padding-top: 5px"><a (click)="setOpen(true, x.event_image)">Click here to open the
                            Image </a>
                        </div>
                        <img class="card-img-top w-100" style="width: 35px; padding-right: 10px;"
                          src="../../assets/imgs/speakers/picture.png" alt="" />
                      </div>
                      <ion-modal [isOpen]="isModalOpen">
                        <ng-template>
                          <ion-header>
                            <ion-toolbar>
                              <ion-buttons slot="end">
                                <ion-button (click)="setOpen(false, 't')">Close</ion-button>
                              </ion-buttons>
                            </ion-toolbar>
                          </ion-header>
                          <ion-content class="ion-padding">
                            <pinch-zoom backgroundColor="rgba(0,0,0,0)">
                              <div>
                                <img class="card-img-top w-100" src="{{ this.modalImage }}" alt="" />
                              </div>
                            </pinch-zoom>
                          </ion-content>
                        </ng-template>
                      </ion-modal>

                      <div *ngIf="checkmp3(x.event_image)">
                        <audio controls controlsList="noplaybackrate nodownload">
                          <source src="{{ x.base64 }}" type="audio/mpeg" *ngIf="x.base64.length > 0" />
                          <source src="{{ x.event_image }}" type="audio/mpeg" *ngIf="x.base64.length == 0" />
                        </audio>
                      </div>

                      <div class="card-header" *ngIf="checkpdf(x.event_image)">
                        <div class="row w-100 align-items-center m-0">
                          <div class="pdf">
                            <div class="col-6" style="padding-top: 10px;">
                              <a (click)="authservice.open(x.event_image)"> Click here to open the PDF </a>
                            </div>
                            <div class="col-6 text-right m-0 p-0">
                              <button type="button" (click)="authservice.open(x.event_image)">
                                <div class="row w-100 align-items-center">
                                  <div class="col-6 w-100 mx-0 px-0" style="padding-right: 10px;">
                                    <img class="w-50 m-auto" src="../../assets/imgs/speakers/spdf.png" />
                                  </div>
                                </div>
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>

                      <div class="card-header" *ngIf="checkxls(x.event_image)">
                        <div class="row w-100 align-items-center m-0">
                          <div class="xls">
                            <div class="col-6" style="padding-top: 10px;">
                              <a (click)="authservice.open(x.event_image)"> Click here to Download the Excel </a>
                            </div>
                            <div class="col-6 text-right m-0 p-0">
                              <button type="button" (click)="authservice.open(x.event_image)">
                                <div class="row w-100 align-items-center">
                                  <div class="col-6 w-100 mx-0 px-0" style="padding-right: 10px;">
                                    <img class="w-50 m-auto" src="../../assets/imgs/Icons_new/Microsoft Excel.png" />
                                  </div>
                                </div>
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </ion-card-content>
        </ion-card> -->

        <div class="card-cls" *ngIf="homeworkdates.length == 0 && sname.length > 0">
          <div class="card-body card_body card-cls-inside">
            <!-- <accordion [closeOthers]="true" [isAnimated]="true">
          <accordion-group heading="{{sname}}" [isOpen]="true" class="inside-cls"> -->
            <table class="custom-table">
              <tbody>
                <tr>
                  <td class="ion-text-center">
                    {{ "no_records_found" | translate }}
                  </td>
                </tr>
              </tbody>
            </table>

            <!-- </accordion-group>
        </accordion> -->
          </div>
        </div>
      </div>

      <!-- <ion-infinite-scroll (ionInfinite)="doInfinite($event)" *ngIf="scroll">
        <ion-infinite-scroll-content loadingSpinner="bubbles" loadingText="{{scroll}}">
        </ion-infinite-scroll-content>
      </ion-infinite-scroll> -->

    </div>
  </pinch-zoom>
</ion-content>